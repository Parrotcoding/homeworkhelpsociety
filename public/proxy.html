<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Proxy</title>
  <script>
    if (sessionStorage.getItem("unlocked") !== "true") {
      window.location.href = "index.html";
    }
  </script>
  <style>
    body {
      background: #0e0e0e;
      color: white;
      font-family: sans-serif;
      height: 100vh;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    form, .widgets {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin: 1rem;
    }

    input, button {
      padding: 0.7rem 1.2rem;
      font-size: 1rem;
      border-radius: 999px;
      border: none;
    }

    input {
      width: 300px;
      outline: none;
    }

    .search-btn {
      background: #1e90ff;
      color: white;
      cursor: pointer;
    }

    .widget-btn {
      background: #222;
      color: white;
      cursor: pointer;
      transition: background 0.2s;
    }

    .widget-btn:hover {
      background: #444;
    }
  </style>
</head>
<body>
  <form onsubmit="openShell(); return false;">
    <input id="urlInput" placeholder="example.com or search keywords..." />
    <button class="search-btn" type="submit">Launch</button>
  </form>

  <div class="widgets">
    <button class="widget-btn" onclick="openShell('https://www.google.com')">üîç Google</button>
    <button class="widget-btn" onclick="openShell('https://duckduckgo.com')">ü¶Ü DuckDuckGo</button>
    <button class="widget-btn" onclick="openShell('https://poki.com')">üéÆ Games</button>
  </div>

  <script>
    function openShell(customUrl = null) {
      let url = customUrl || document.getElementById('urlInput').value.trim();
      if (!url) return;

      if (!/^https?:\/\//i.test(url) && !url.includes(".")) {
        url = "https://www.google.com/search?q=" + encodeURIComponent(url);
      } else if (!/^https?:\/\//i.test(url)) {
        url = "https://" + url;
      }

      const win = window.open('about:blank');
      const escapedUrl = encodeURIComponent(url);

      const doc = win.document;
      doc.open();
      doc.write(`<!DOCTYPE html>
<html>
<head>
  <title>Marauder's Proxy Shell</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #0d0d0d;
      color: white;
      font-family: 'Georgia', serif;
      overflow: hidden;
    }

    #unfoldShell {
      position: fixed;
      top: 0;
      right: 0;
      width: 100px;
      height: 100px;
      background: #151515;
      border: 2px solid #333;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(255,255,255,0.1);
      animation: unfold 1s ease-out forwards;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    @keyframes unfold {
      0% {
        width: 100px;
        height: 100px;
        transform: translate(0, 0) scale(0.2);
        opacity: 0.2;
      }
      60% {
        opacity: 1;
      }
      100% {
        width: 100vw;
        height: 100vh;
        transform: translate(0, 0) scale(1);
        border-radius: 0;
      }
    }

    #proxyFrame {
      flex-grow: 1;
      width: 100%;
      height: 100%;
      border: none;
    }

    form {
      margin: 10px;
      display: flex;
    }

    input, button {
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      border-radius: 999px;
      border: none;
      outline: none;
    }

    input {
      width: 280px;
    }

    button {
      background: #1e90ff;
      color: white;
      margin-left: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="unfoldShell">
    <form onsubmit="loadProxy(); return false;">
      <input id="urlBar" placeholder="Enter URL or search..." />
      <button type="submit">Go</button>
    </form>
    <iframe id="proxyFrame"></iframe>
  </div>

  <script>
    function loadProxy() {
      let u = document.getElementById('urlBar').value.trim();
      if (!/^https?:\\/\\//i.test(u) && !u.includes(".")) {
        u = "https://www.google.com/search?q=" + encodeURIComponent(u);
      } else if (!/^https?:\\/\\//i.test(u)) {
        u = "https://" + u;
      }
      document.getElementById('proxyFrame').src = "/proxy?url=" + encodeURIComponent(u);
    }
    document.getElementById('urlBar').value = decodeURIComponent("${escapedUrl}");
    loadProxy();
  <\/script>
</body>
</html>`);
      doc.close();
    }
  </script>
</body>
</html>
